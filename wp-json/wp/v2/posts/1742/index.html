{"id":1742,"date":"2023-08-14T15:53:30","date_gmt":"2023-08-14T10:23:30","guid":{"rendered":"https:\/\/specmatic.dvox.biz\/?p=1742"},"modified":"2023-08-14T17:09:37","modified_gmt":"2023-08-14T11:39:37","slug":"jdbc-stubbing-with-specmatic-contract-testing","status":"publish","type":"post","link":"https:\/\/specmatic.dvox.biz\/updates\/jdbc-stubbing-with-specmatic-contract-testing\/","title":{"rendered":"Break the Chains of Database Dependencies: Leveraging Specmatic for JDBC Stubbing"},"content":{"rendered":"\n<figure class=\"wp-block-embed is-type-video is-provider-youtube wp-block-embed-youtube wp-embed-aspect-16-9 wp-has-aspect-ratio\"><div class=\"wp-block-embed__wrapper\">\n<div class=\"ast-oembed-container \" style=\"height: 100%;\"><iframe title=\"Break the Chains of Database Dependencies: Leveraging Specmatic for JDBC Stubbing\" width=\"500\" height=\"281\" src=\"https:\/\/www.youtube.com\/embed\/2-zqzBvFjnc?feature=oembed\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen><\/iframe><\/div>\n<\/div><\/figure>\n\n\n\n<div style=\"height:30px\" aria-hidden=\"true\" class=\"wp-block-spacer\"><\/div>\n\n\n\n<h2 class=\"wp-block-heading\"><strong>Context<\/strong><\/h2>\n\n\n\n<p>To test our applications effectively on our local machines and in lower environments such as CI pipelines, we often need to isolate them from their database dependencies to make sure that the test environment is simple to set up and our tests themselves are quick to run. A few popular options that come to mind to achieve the same include in-memory databases and containerised databases. However, there are limitations to each of these approaches.<\/p>\n\n\n\n<ol>\n<li><strong>In-memory DBs<\/strong> &#8211; They are <strong>database simulators<\/strong> and usually cannot handle syntax and data types that may be proprietary \/ vendor specific to your database. Legacy applications with stored procedures may be even harder to deal with.<\/li>\n\n\n\n<li><strong>Containerised DBs<\/strong> &#8211; They are <strong>real databases<\/strong> and thereby also involve significant effort initially to achieve parity with your production database in terms of schema and data setup (Especially in legacy applications which lack automated DB deployment mechanisms).<\/li>\n<\/ol>\n\n\n\n<p>To overcome these limitations we need a \u201c<strong>Database Stub<\/strong>\u201d.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\"><strong>Solution<\/strong><\/h2>\n\n\n\n<p><strong>Specmatic JDBC Stub<\/strong> is a completely <strong>wire-compatible<\/strong> setup that has none of the above limitations. It is able to seamlessly stub a JDBC datasource because of which your application thinks it is talking to a real database. This helps in creating a realistic test environment that can be quickly spun up in-memory.<\/p>\n\n\n\n<h2 class=\"wp-block-heading\"><strong>Key features<\/strong><\/h2>\n\n\n\n<ol>\n<li><strong>Eliminate Database Dependency:<\/strong> JDBC stubs allow us to isolate APIs from their database dependencies, enabling us to test without the need for a complex DB setup. By switching out the data source with a Specmatic JDBC stub, the API can communicate with the stub instead of the actual database.<\/li>\n\n\n\n<li><strong>Define \/ Record and Replay Expectations<\/strong>: With Specmatic JDBC stub, we can set expectations for queries and their responses. These expectations can be written by hand or recorded based on actual interactions between the API and a real database. This allows you to verify that your application is only interacting with the database as intended by you.<\/li>\n\n\n\n<li><strong>Stub vendor specific SQL syntax<\/strong> &#8211; Since Specmatic JDBC stub operates at the level of abstraction of a DataSource, you can effectively stub all types of interactions including stored procedure calls.<\/li>\n\n\n\n<li><strong>Blazing Fast In-memory Setup<\/strong> &#8211; Super charge your tests (component, contract and API tests and more) with Specmatic\u2019s fast in-memory JDBC stubbing capability that speeds up your overall test execution time thereby making for a great Developer Experience.<\/li>\n<\/ol>\n\n\n\n<p>By leveraging Specmatic JDBC stubs, we can effectively test APIs, reduce dependencies, and ensure the reliability and integrity of our applications.<\/p>\n\n\n\n<h3 class=\"wp-block-heading\">Check out the sample code<\/h3>\n\n\n\n<p><strong>Sample project: <\/strong><a href=\"https:\/\/github.com\/znsio\/specmatic-jdbc-sample\">Manual configuration<\/a><strong><\/strong><br><strong>Sample project: <\/strong><a href=\"https:\/\/github.com\/znsio\/specmatic-jdbc-sample\/tree\/spring-auto-configuration\">Spring auto-configuration<\/a><\/p>\n\n\n\n<p><strong>Download Specmatic:<\/strong> <a href=\"https:\/\/github.com\/znsio\/specmatic\/releases\">https:\/\/github.com\/znsio\/specmatic\/releases<\/a><\/p>\n\n\n\n<p><a href=\"https:\/\/specmatic.in\/contact-us\/\">Contact us<\/a> to join the private beta.<\/p>\n\n\n\n<p><\/p>\n\n\n\n<figure class=\"wp-block-image size-full\"><img fetchpriority=\"high\" decoding=\"async\" width=\"975\" height=\"720\" src=\"https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/specmatic-jdbc-stubbing.gif\" alt=\"Jdbc stubing production mode jdbc stubing test mode Redis Stubbing with Specmatic Contract Testing.\" class=\"wp-image-1744\"\/><\/figure>\n\n\n\n<div style=\"height:30px\" aria-hidden=\"true\" class=\"wp-block-spacer\"><\/div>\n\n\n\n<h2 class=\"wp-block-heading\"><strong>Benefits of Specmatic JDBC Stub: Replacing Real Data Sources &amp; Enhancing the Testing Process<\/strong><\/h2>\n\n\n\n<p>At the core of the testing process lies the ability to isolate the application from its database dependency. Specmatic JDBC stub achieves this by replacing the real data source with a Specmatic data source. By doing so, the API under test communicates with the Specmatic JDBC stub instead of the actual database. This allows developers to run different types of tests without the hassle of depending on a complex database setup. The Specmatic JDBC stub acts as a drop in replacement for&nbsp; the database in your test environments, ensuring smooth communication and accurate test results.<\/p>\n\n\n\n<h3 class=\"wp-block-heading\">Setting Expectations with Specmatic JDBC Stub for Contract-Based API Testing<\/h3>\n\n\n\n<p>To effectively use Specmatic JDBC stub, the first step is to set expectations with the stub regarding the queries that it can expect and the corresponding data it needs to respond with. These expectations can be manually written or recorded based on actual interactions between the API and a real database. Once the expectations are set, the real database is no longer required in the testing setup. <\/p>\n\n\n\n<div style=\"height:30px\" aria-hidden=\"true\" class=\"wp-block-spacer\"><\/div>\n\n\n\n<h3 class=\"wp-block-heading\"><strong>Code walkthrough: Specmatic JDBC Stub for Testing<\/strong><\/h3>\n\n\n\n<p>Let&#8217;s delve into a concrete example to illustrate the power of the Specmatic JDBC stub. Consider an application that provides a wrapper for managing product entities. In its production configuration, it relies on a real database for data storage. <\/p>\n\n\n\n<figure class=\"wp-block-image size-full\"><img decoding=\"async\" width=\"1500\" height=\"688\" src=\"https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC1-1.jpg\" alt=\"A screen shot showcasing Specmatic's JDBC stubbing capabilities to liberate from database dependencies.\" class=\"wp-image-1781\" srcset=\"https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC1-1.jpg 1500w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC1-1-300x138.jpg 300w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC1-1-1024x470.jpg 1024w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC1-1-768x352.jpg 768w\" sizes=\"(max-width: 1500px) 100vw, 1500px\" \/><\/figure>\n\n\n\n<div style=\"height:30px\" aria-hidden=\"true\" class=\"wp-block-spacer\"><\/div>\n\n\n\n<p>However, for testing purposes, we want to isolate the application from the actual database. By disabling the data source auto-configuration, the application loses its ability to communicate with the real database. <\/p>\n\n\n\n<figure class=\"wp-block-image size-full\"><img decoding=\"async\" width=\"1500\" height=\"503\" src=\"https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC2.jpg\" alt=\"A code editor with JDBC Stubbing capabilities.\" class=\"wp-image-1782\" srcset=\"https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC2.jpg 1500w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC2-300x101.jpg 300w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC2-1024x343.jpg 1024w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC2-768x258.jpg 768w\" sizes=\"(max-width: 1500px) 100vw, 1500px\" \/><\/figure>\n\n\n\n<div style=\"height:30px\" aria-hidden=\"true\" class=\"wp-block-spacer\"><\/div>\n\n\n\n<figure class=\"wp-block-image size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"1500\" height=\"391\" src=\"https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC7.jpg\" alt=\"Using Specmatic for JDBC Stubbing to break database dependencies in a web browser screenshot.\" class=\"wp-image-1789\" srcset=\"https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC7.jpg 1500w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC7-300x78.jpg 300w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC7-1024x267.jpg 1024w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC7-768x200.jpg 768w\" sizes=\"(max-width: 1500px) 100vw, 1500px\" \/><\/figure>\n\n\n\n<div style=\"height:30px\" aria-hidden=\"true\" class=\"wp-block-spacer\"><\/div>\n\n\n\n<p>Instead, we configure the Specmatic JDBC stub as the data source for testing. This is achieved by adding the Specmatic JDBC dependency and setting up a bean for the data source, specifying the port and directory where the expectations are stored.<\/p>\n\n\n\n<figure class=\"wp-block-image size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"1500\" height=\"776\" src=\"https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC4.jpg\" alt=\"Leveraging Specmatic for JDBC Stubbing in a code editor screen of Adobe Acrobat.\" class=\"wp-image-1786\" srcset=\"https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC4.jpg 1500w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC4-300x155.jpg 300w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC4-1024x530.jpg 1024w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC4-768x397.jpg 768w\" sizes=\"(max-width: 1500px) 100vw, 1500px\" \/><\/figure>\n\n\n\n<div style=\"height:30px\" aria-hidden=\"true\" class=\"wp-block-spacer\"><\/div>\n\n\n\n<h3 class=\"wp-block-heading\">Seamless Contract Testing with the Specmatic JDBC Stub and OpenAPI Specification<\/h3>\n\n\n\n<p>With the Specmatic JDBC stub in place, we can now run contract tests based on the OpenAPI specification of the API. These tests make HTTP requests to the application, which in turn communicates with the Specmatic data source. <\/p>\n\n\n\n<p>The data source responds with the predefined data that was set up as part of the expectations. <\/p>\n\n\n\n<figure class=\"wp-block-image size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"1500\" height=\"617\" src=\"https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC5.jpg\" alt=\"Leveraging Specmatic for JDBC Stubbing in a code editor screenshot.\" class=\"wp-image-1787\" srcset=\"https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC5.jpg 1500w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC5-300x123.jpg 300w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC5-1024x421.jpg 1024w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC5-768x316.jpg 768w\" sizes=\"(max-width: 1500px) 100vw, 1500px\" \/><\/figure>\n\n\n\n<div style=\"height:30px\" aria-hidden=\"true\" class=\"wp-block-spacer\"><\/div>\n\n\n\n<p>When Specmatic JDBC stub receives queries that it is not expecting, it throws errors to indicate the same thereby giving us feedback when our application code is making any additional calls to the database.<\/p>\n\n\n\n<figure class=\"wp-block-image size-full\"><img loading=\"lazy\" decoding=\"async\" width=\"1500\" height=\"460\" src=\"https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC6.jpg\" alt=\"A screenshot of Specmatic, a Java script editor for breaking database dependencies by leveraging JDBC stubbing.\" class=\"wp-image-1788\" srcset=\"https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC6.jpg 1500w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC6-300x92.jpg 300w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC6-1024x314.jpg 1024w, https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/JDBC6-768x236.jpg 768w\" sizes=\"(max-width: 1500px) 100vw, 1500px\" \/><\/figure>\n\n\n\n<div style=\"height:30px\" aria-hidden=\"true\" class=\"wp-block-spacer\"><\/div>\n\n\n\n<p>From the application&#8217;s perspective, it appears as if it is interacting with the real database. The application processes the data and returns it to the Specmatic contract test, which then validates if the response conforms to the schema described in the OpenAPI specification. <\/p>\n\n\n\n<p>This seamless integration allows developers to confidently test their applications while eliminating the need for an actual database.<\/p>\n\n\n\n<h3 class=\"wp-block-heading\">The Benefits of Utilising Specmatic JDBC Stub for Testing Applications with Database Dependencies<\/h3>\n\n\n\n<p>In conclusion, Specmatic JDBC stub provides a powerful solution for testing applications with database dependencies. By replacing the real data source with the Specmatic data source, developers can easily isolate their applications from complex database setups in their test environments and perform comprehensive tests including API, contract tests and more. For example, with Specmatic&#8217;s ability to generate contracts from OpenAPI specifications (API specifications as contract tests), developers can verify the correctness of their APIs without the need for an actual database instance. <\/p>\n\n\n\n<p>By leveraging Specmatic JDBC stub, developers can streamline the testing process, increase test coverage, and ensure the reliability and stability of their applications.<\/p>\n\n\n\n<p><\/p>\n\n\n\n<p><strong>Sample project: <\/strong><a href=\"https:\/\/github.com\/znsio\/specmatic-jdbc-sample\">Manual configuration<\/a><br><strong>Sample project: <\/strong><a href=\"https:\/\/github.com\/znsio\/specmatic-jdbc-sample\/tree\/spring-auto-configuration\">Spring auto-configuration<\/a><\/p>\n\n\n\n<p><strong>Download Specmatic:<\/strong> <a href=\"https:\/\/github.com\/znsio\/specmatic\/releases\">https:\/\/github.com\/znsio\/specmatic\/releases<\/a><\/p>\n\n\n\n<p><a href=\"https:\/\/specmatic.in\/contact-us\/\">Contact us<\/a> to join the private beta.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>With Specmatic JDBC stub, you can easily test APIs without the need for a complex database setup. By switching out the real database with a Specmatic JDBC stub, we can set expectations for the stub to respond to specific queries. These expectations can be recorded based on actual interactions. Once the expectations are set, we no longer need the database for our tests!<\/p>\n","protected":false},"author":3,"featured_media":1743,"comment_status":"closed","ping_status":"open","sticky":false,"template":"","format":"video","meta":{"_seopress_robots_primary_cat":"","_seopress_titles_title":"","_seopress_titles_desc":"","_seopress_robots_index":"","_uag_custom_page_level_css":"","site-sidebar-layout":"default","site-content-layout":"","ast-site-content-layout":"","site-content-style":"default","site-sidebar-style":"default","ast-global-header-display":"","ast-banner-title-visibility":"","ast-main-header-display":"","ast-hfb-above-header-display":"","ast-hfb-below-header-display":"","ast-hfb-mobile-header-display":"","site-post-title":"","ast-breadcrumbs-content":"","ast-featured-img":"disabled","footer-sml-layout":"","theme-transparent-header-meta":"","adv-header-id-meta":"","stick-header-meta":"","header-above-stick-meta":"","header-main-stick-meta":"","header-below-stick-meta":"","astra-migrate-meta-layouts":"default","ast-page-background-enabled":"default","ast-page-background-meta":{"desktop":{"background-color":"var(--ast-global-color-4)","background-image":"","background-repeat":"repeat","background-position":"center center","background-size":"auto","background-attachment":"scroll","background-type":"","background-media":"","overlay-type":"","overlay-color":"","overlay-gradient":""},"tablet":{"background-color":"","background-image":"","background-repeat":"repeat","background-position":"center center","background-size":"auto","background-attachment":"scroll","background-type":"","background-media":"","overlay-type":"","overlay-color":"","overlay-gradient":""},"mobile":{"background-color":"","background-image":"","background-repeat":"repeat","background-position":"center center","background-size":"auto","background-attachment":"scroll","background-type":"","background-media":"","overlay-type":"","overlay-color":"","overlay-gradient":""}},"ast-content-background-meta":{"desktop":{"background-color":"var(--ast-global-color-5)","background-image":"","background-repeat":"repeat","background-position":"center center","background-size":"auto","background-attachment":"scroll","background-type":"","background-media":"","overlay-type":"","overlay-color":"","overlay-gradient":""},"tablet":{"background-color":"var(--ast-global-color-5)","background-image":"","background-repeat":"repeat","background-position":"center center","background-size":"auto","background-attachment":"scroll","background-type":"","background-media":"","overlay-type":"","overlay-color":"","overlay-gradient":""},"mobile":{"background-color":"var(--ast-global-color-5)","background-image":"","background-repeat":"repeat","background-position":"center center","background-size":"auto","background-attachment":"scroll","background-type":"","background-media":"","overlay-type":"","overlay-color":"","overlay-gradient":""}},"footnotes":""},"categories":[58,14],"tags":[20,19,63,60],"uagb_featured_image_src":{"full":["https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/SpecmaticJDBC-stubbing.jpg",1400,788,false],"thumbnail":["https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/SpecmaticJDBC-stubbing-150x150.jpg",150,150,true],"medium":["https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/SpecmaticJDBC-stubbing-300x169.jpg",300,169,true],"medium_large":["https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/SpecmaticJDBC-stubbing-768x432.jpg",768,432,true],"large":["https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/SpecmaticJDBC-stubbing-1024x576.jpg",1024,576,true],"1536x1536":["https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/SpecmaticJDBC-stubbing.jpg",1400,788,false],"2048x2048":["https:\/\/specmatic.dvox.biz\/wp-content\/uploads\/2023\/08\/SpecmaticJDBC-stubbing.jpg",1400,788,false]},"uagb_author_info":{"display_name":"Hari Krishnan","author_link":"https:\/\/specmatic.dvox.biz\/author\/hari\/"},"uagb_comment_info":0,"uagb_excerpt":"With Specmatic JDBC stub, you can easily test APIs without the need for a complex database setup. By switching out the real database with a Specmatic JDBC stub, we can set expectations for the stub to respond to specific queries. These expectations can be recorded based on actual interactions. Once the expectations are set, we&hellip;","_links":{"self":[{"href":"https:\/\/specmatic.dvox.biz\/wp-json\/wp\/v2\/posts\/1742"}],"collection":[{"href":"https:\/\/specmatic.dvox.biz\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/specmatic.dvox.biz\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/specmatic.dvox.biz\/wp-json\/wp\/v2\/users\/3"}],"replies":[{"embeddable":true,"href":"https:\/\/specmatic.dvox.biz\/wp-json\/wp\/v2\/comments?post=1742"}],"version-history":[{"count":12,"href":"https:\/\/specmatic.dvox.biz\/wp-json\/wp\/v2\/posts\/1742\/revisions"}],"predecessor-version":[{"id":1816,"href":"https:\/\/specmatic.dvox.biz\/wp-json\/wp\/v2\/posts\/1742\/revisions\/1816"}],"wp:featuredmedia":[{"embeddable":true,"href":"https:\/\/specmatic.dvox.biz\/wp-json\/wp\/v2\/media\/1743"}],"wp:attachment":[{"href":"https:\/\/specmatic.dvox.biz\/wp-json\/wp\/v2\/media?parent=1742"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/specmatic.dvox.biz\/wp-json\/wp\/v2\/categories?post=1742"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/specmatic.dvox.biz\/wp-json\/wp\/v2\/tags?post=1742"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}